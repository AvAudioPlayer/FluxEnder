# FluxEnder README


[Homepage][4] of this project. Learn some chinese, buddy.

---
DIRs

### **output**
generated by /src/classify_domain.py

* fn.txt: flase negative domains
* fp.txt: false positive domains

### **resources**
white\black\CDN domain lists

* cdn.txt: top 50 cdn domains in this planet(manually generated)
* cdn_ip.txt: IPs associated with cdn domains above
* cdn_new.txt: domains which use ips in cdn_ip.txt (cdn_ip.txt and cdn_new.txt are generated by /scripts/find_cdn_user.py)
* domain_whitelist.txt: domains that are legal, which means they might be classified as malicious(manually generated)
* hosts_*: different kinds of malicious domains(generated by /scripts/update_malware_files.py and /scripts/update_malware_files.sh)
* top-1m.csv: Alexa top 1m sites(downlaod from Alexa)

### **scripts**

* drop.py: drop collections or dbs from mongo
* find_cdn_cname.py: CDN domains my use CNAME recours recursively, this script can find all the domain names recursively
* find_cdn_user.py: find domains that use CDN IP
* plotting.py: plot various graphs to show the difference between legal and malicious on features
* printting.py: ancient code, for feature value show, work well with interruption
* test.py: tests as it is...
* update_malware_files.*: malware blocklist are frequently updated, so update them


### **src**

* models: dga detection related, (check [here][1])
* \__init__.py: kinds of global variables
* classify_domain.py: run on labeled domains and features extracted to check whether the model works, this is the last step
* dga_model_eval.py: dga detection related, (check [here][1])
* extract_feature.py: extract features from raw data, slow
* extract_feature_lib.py: imported by extract_feature.py
* log_to_mongo.py: read log file, store into mongo
* log_to_mongo_lib.py: imported by log_to_mongo.py
* worker.py: the 'main()' for log_to_mongo and extract_feature (python, glue language)

-----
STEPs

1. download [dns log][3] from [here][2]
2. update malicious blocklist, find cdns names
3. log to mongo
4. extract feature
5. classify model

----
Tuning

* The malicious domains used(!!)
* CDN names you use(!!)
* Thresholds in classify_domain.py(!!!)

----

Good luck, :)
in case you need help, **chenkainp@gmail.com**


[1]: https://github.com/whodewho/FluxEnder
[2]: http://pan.baidu.com/s/11sYFs
[3]: https://github.com/gamelinux/passivedns
[4]: http://kthinker.com/2014/06/01/detection-of-malicious-domains-based-on-passive-dns-analysis.html




